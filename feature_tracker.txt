                      
                        *------------------------*
                        | Skeletris Planning Doc |
                        *------------------------*
                      
[P1 bugs]
 - there are probably issues with fullscreening if you have multiple monitors w/ different sizes

[P2 bugs]
 - if you have temporary speed boost that's about to expire, enemies with z's can act after you move
    - need to math a little harder here (or just leave it...)
 - tutorial text renders awkwardly when it overlaps very large enemies
 - going in and out of fullscreen mode loses the window position (or something like that?)
 - amphibian song is too quiet?
 - player is standing up for a single frame at start of game
 - shouldn't output the generated zone to the console if we aren't in dev mode
 
[story bugs]
 - S.K.U.L doesn't actually stand for anything
    - replace with "B.O.S.S.", maybe?
        - "Better Organization System for Skeletris"
        - "Benevolent Organization System for Skeletris"


[story planning]
 - core
    - mary: "the bones... they're everywhere. who could do this"
 - cave horror zone
    - who should be in the cave horror zone?
        - everyone? (maybe not beanskull?)
    - mary: "look at all these heads, how terrible"
    - mayor: "whatever's in that room, it's the most valuable mushroom ever"
    - grok: "we'll start putting them back together, you investigate the vault"
 - post cave horror zone
    - doctor?: "it seems to be using some kind of mind control"
        - "the animals in the swamp, even the undead, they all have the same fungal infection"
        - "but it doesn't match this one. there's something else controlling them"
 - unearthed
    
 
[testing]
 - make sure that statuses 'apply' the correct number of times
 - test anything on mac (where can i find a mac?)


[balance issues]    
 - spider boss can be 'out-of-sync' with hit and step technique, causing confusion
    - teach player to skip their turn at the same time?
    - somehow force it to be in-sync?
        - like setting its energy to 0 or 2 something when the door opens?
    - also with 3~ defense you can pretty much just facetank it
 - robo boss should do something
    - he big. he tuff. maybe that's enough
 
 
[current features]
 - the story
   - the big reveal after fighting robo
   
 - finalize robo boss fight 
 
 - finalize nameless boss fight
    - it would be so cool if there was some kind of "preview" for this fight 
      earlier in the game... even just a line of dialog or something
    - also please just come up with a name... this is stupid
 
 - figure out how to make 32-bit windows builds
    - download 32-bit python and dependencies and fire away?
    - could also consider only shipping 32 bit exes?
        - i think this is normal way, yeah
    

[maintanence]
 - fix up project requirements. can probably update all the dependencies (even python)
 
 
[what's stressing me out?]
 - won't ever finish
    - potentially true. it's up to you
 - "it took you X years to make this?"
    - it's hard to predict reception. don't let it paralyze you.
 - new players will struggle and quit
    - you'll playtest the tutorial system before release, and you might be 
        surprised at how well players can figure this stuff out.
 - boss fights aren't very interesting
    - you weren't even supposed to *have* those in the first place, remember? 
        just having them at all is more interesting than not, and they don't 
        necessarily need to play a huge role in the game to be memorable.
    - also they're actually better than they seem
        - frog boss tests the player's ability to sidestep attacks
        - robot boss tests player's ability to use CC
 - none of it's very interesting
    - done is better than interesting
    
 
[architecture]
    - entities should keep a reference to the world they're in
        - instead of passing the world into literally every method
    
    
[content design philosophy]
    - if you can't make it in two tries, cut it
        - (unless it's absolutely essential)
    - done is better than good
    - but if it's bad cut it
    
        
[future features]
 - traps / ground effects
 - some kind of checkpoint system (?)
    - wouldn't be too hard to implement actually
    - could be one-time-use?
 - enemies picking up items (intelligence >= 4)
    - we'd want an "arms up" sprite for eligible enemies I think
 - holding the up/down key in menus should continue scrolling
    - careful, the hold-down behavior on keys differs between OSes
 - projectiles should get a color based on the item/status or something
 - tiles that alter movement
    - jump / teleport tiles
        - an interesting way to get away from enemies, assuming they don't follow you
        - could use "ReturnExitEntity" sprites for this
            - although tests have shown people are afraid of it..
        - this also makes the maps a lot more "mazy" and harder to visualize
    - ice tiles
        - these would be interesting to try to generate
        - enemy pathing on these would be a bit tricky / interesting
    - water tiles (kill or hurt you when you fall in)
        - only meaningful if knockback is a thing
    - one-way tiles
        - (not sure what these would be good for, honestly.)
            - force engagement?
                - running away is sorta hopeless already
                    - and turtling in doorways only works if you can facetank the enemy
 - backstab attack 
    - jump over target, attack from other side (if possible)
 - new (secondary) item stats
    - poison duration
    - confusion duration
 - quest system
 - permanent effects (aka curses)
 - doors that can only be unlocked with "keys"
 - varying scenery
    - bridges over deep pits, water pits
 
 - figure out whether it's possible to make/distribute mac builds
    - no opengl? no app notarizaiton w/out developer account? looking grim...
        - confident i could do this iff i had a mac computer at my disposal
            - 300-400 for a cheap laptop
                - 600-800 probably more realistic (refurb'd 2015 macbook air?)
            - 150-200 for a mac mini (are these even computers?)
 
 - make enemies move at the same time as you...?
    - this would be my #1 complaint with the game if I were a player
    - there's a reason why all other roguelikes do this...
    - this will require a lot of work though
        - essentially:
            - gets complicated when enemies are taking multiple actions during a single player turn
            - we actually don't even know in advance how many total steps will be taken by enemies during this phase
                - depends on various speed-affecting actions that may or may not be taken
            - so it seems like we'd have to pre-compute the entire phase, and play it back at the proper speed
            - actually, it might not be so bad if only MoveActions are affected
                - but I want to be able to toggle other things too.
            - actually, if we could represent the worldstate (as it pertains to actors) in more abstract way..
            - HMMM
            
            - Plan A
                - player chooses an action A0.
                - take a snapshot S0 of the current worldstate (or a relevant part of it)
                - compute S1 = A0(S0) (the worldstate after the player's action has resolved)
                - compute the first enemy's action A1 given S1, and let S2 = A1(S1)
                    - if A_e1 is non-concurrent, animate Ap, then A1
                    - else find A2, A3, A4, and so on until a non-concurrent action is found 
                        - or until it's the player's turn again
                        - hidden enemies do not animate, and therefore their actions are always concurrent
                        - if the player is gone (AKA dead), all actions are non-concurrent
                        
                - then: during animation, sort the actions into lists for each actor
                - and animate them concurrently 
                    - increasing the anim rate for longer lists so that all animations finish at the same time.
                    
            - issues with Plan A:
                - how to represent the state of an actor?
                    - position
                    - HP
                    - energy
                    - base stats
                    - list of stat modifiers (with X turns remaining)
                        - this basically includes items and status effects
                        
                - how to handle 'unusual actions' like interacting with scenery or talking to an NPC?
                    - have them be "non-concurrent" and skip this entire process
                - how to update the 'true' worldstate after the animation phase has occurred?
                    - just finalize actions as they occur (mid-animation)?
                        - no, they absolutely must be called in order
                    - do a "full finalize" of the world at the end?
                    - refactor current world to have it basically represented this way to begin with
                        - aka decouple the model from the view
                
 - use N "dividers" on HP bar where N = max health
 - when enemies are "flinched" it should be shown to the player somehow
    - in the tooltip?
    - this should be done with pink zees I think, and other status effects should have similar effects
        - or just regular zees?
        - or just flash the status's color...?
    

[rejected future features]
 - consider allowing two weapons to be equipped at maximum
    - there currently is almost no reason to have more than 1, let alone two
    - this would allow for a simpler UI
        - you'd have an active / offhand weapon, and a button to swap
    - would allow weapons to have global stats (not currently possible because 
      it'd become more efficient to stack small weapons instead of cubes)
    - would need to elegantly "fail to equip" somehow
    - putting skeletons back together with bone pieces
  


[~dream features~]
 - farming
    - if you can dream it you can meme it
 
 
[P3 bugs]
    - when you pop a dialog, player keeps current animation (most noticeable if walking)
    - offscreen light sources that are somewhat nearby will make offscreen enemies act non-instantly
        - for now, let's just not have any enemies that emit light by default
            - oops, tree boss emits light...
    - HP on kill doesn't trigger when you kill an enemy with poison
        - I think this makes the game better. leave it.
    - as frog boss is leaping diagonally, it'll activate player's attack targeting squares
    - right clicking a potion in the equipment grid moves it to the inventory (it should consume)
        
[playtesting notes]

 - coffee shop guy (nervous dog) (7/21/19)
    situation: stranger, asked what i was working on, i offered to let him playtest
    - 45 minutes, made it through 2 levels
    - thought flashing red dagger meant it would break soon
    - couldn't figure out how to pick up items (mouse)
    - couldn't figure out how how to open inventory
    - couldn't figure out how how to rotate items
    - avoided ReturnExitEntity, thought it was fire and would kill him
        - correct behavior, but incorrect reasoning. probably fine?
    - put dagger into inventory instead of equipment grid
    - but figured out how to use the dagger from hotbar without help (pressed 1)
    - lot of awkward hand alternating with controls
    - compulsively picking up, equipping items
        - swapping an rearranging items even when their stats were the same
        - judging items based on color, rather than stats? 
            - thought a yellow item affected speed.
        - eventually became seemingly annoyed whenever an item would drop, would check phone, look away, etc
        - filled up entire inventory with garbage items
    - thought vitality was different from HP
    - seemed bored, playing to pass the time and be polite
        - obv not a fan of the genre, but concerning nonetheless
    - story seemed to amuse him at first, bore him as time went on
    - said art was good, but "programming seems basic"
        - not sure what this means, hurt though lol
    - didn't understand why he couldn't pick up items two squares away
    
    takeaways: 
        - ~early game is slow, easy, confusing, and boring~
        - way too many chests
        - need in-game tutorial
        - shift click to auto-pickup items
        - better indicator when item is too far away to be picked up
        - needs to be possible to die in early levels
        - early levels potentially should be a lot smaller?
        - might want to prevent "ATT" items from being pure yellow
        
 - jeff (home) (8/25/19)
    situation: friend, invited him to playtest
        - 35 minutes, played four games, died at caves 2 or 3 each time
        - most early tutorials in place, game was untuned, pretty hard
    good:
        - equipment and rotation tutorials worked!
        - used item tooltips to decide what to replace when equip space ran out
    neutral:
        - scared of enemies at first, wouldn't fight anything
        - used mouse + inventory hotbar button to open inventory thereafter
    bad:
        - pressed arrow keys before "[WASD]" message appeared, used them throughout
        - had to instruct how to use potions (tried dragging it onto player)
            - didn't really get to see tutorial text because it was on mouse while trying to use it.
        - often tried moving items via drag-n-drop instead of click-move-click
        - rapidly mashed movement keys while fighting, didn't seem to grasp concept of turn-basedness
            - kept doing it after i explained why it wasn't necessary, kept doing it anyways
            - perhaps more of a mental tic in response to stress
        - ran past enemies even whenever possible, causing him to recieve no potions and die in later levels
        - didn't realize you could attack enemies by running into them
        - struggled to equip dagger
            - tried dragging it onto player
            - tried right-clicking it in inventory
            - confused about what "Throwable" meant
            - had to instruct how to select it (there's no in-game explanation for this currently)
        - noticed Zzz's on enemies, but didn't understand what it meant or how to take advantage
            - even after explanation and demonstration, couldn't (immediately~) start fighting slow enemies safely 
        - never tried hovering over enemies to see stats
        
    takeaways:
        - need to streamline the way weapons are equipped. 
            - it should *just work* when you put a weapon into the equipment grid
            - only two attacks available, and a maximum of two weapons equipped
        - there should be a way to recover life at the end of a level
        - drag-n-drop should work
        - disable arrow keys as default controls, it just screws people up
        - need some non-enemy challenges in early levels, to introduce the movement and turn system
        - clicking a potion onto yourself should probably just use it~
        - clicking an equipment onto yourself should equip it if possible
        

[game name]

    [CAN'T USE] Cubelike 
        - blend of roguelike and "cube" (?)
        - been using this as the name since the beginning
        - don't really want to use word "Cube" because it's awkward to say/hard to hear
            - "it's called kyubelike"
            - what?
            - "it's cube-like, like roguelike, if you pronounce it wrong"
    
    Skeletris
        - pros:
            - sounds cool
            - available
            - this can also be the name of the city in which the game takes place
        - cons:
            - similar to "Dungetris" which is an existing indie tetris-roguelike fusion
                - games are totally different though, probably fine to use
            - says basically nothing about the game except "there are skeletons + tetris"
            - there are like four ppl using this name on social media accounts
                - sorry kids, it's mine now
    
    Slap Monsters, Find Loot
        - cute, memorable, 2nd half needs work
        - hate the word "loot"
        - SMFL = "ess em eff ell" sucks
        
    Slap Monster, Get Treasure
        - pros:
            - SMGT = "ess em gee tee", pretty good, acronym available
            - sounds like lgbt
            - describes all important parts of the game
        - cons:
            - ambiguously necessary comma
            - ambiguously necessary "s" after Monster
            - it's too stupid
            - one day later, i hate it
            
    [CAN'T USE] Tomb of the Mushroom King
        - cons:
            - identical to "Crypt of the Fungal Lord", which exists
            - similar to "Curse of the Mushroom King", which exists
            
