                      
                        *------------------------*
                        | Skeletris Planning Doc |
                        *------------------------*
                      
[P1 bugs]
 - there many issues with fullscreening if you have multiple monitors
    - it's not really supported by pygame / SDL (are you kidding me?!)

[P2 bugs]
 - if you've ever (ever) popped the map before it shouldn't show the map tutorial.

[distribution bugs]
 - windows freaks out when you try to run the exe (how do I authorize it?)
    - it seems like the only way around this is to get a digital certificate,
      which costs hundreds of dollars and requires me to be a company?
    - this is kind of a non-starter
 
[story bugs]
 - mary doesn't have repeat dialog at many places


[testing]
 - test anything on mac (where can i find a mac?)
    - zach says it doesn't work on mac anymore... rip
        - most likely due to the OpenGL version change
        - it would be nice if I had a mac to test on...


[balance issues]    
 - players can quite easily forget how to rotate items or skip turns
    - realistically, they can just look at the store page / controls menu
 - slow potions are a bit OP against bosses
    - maybe OK? bosses are pretty tough otherwise...
 
[current features] 
 - figure out how to make 32-bit windows builds
    - download 32-bit python and dependencies and fire away?
    - could also consider only shipping 32 bit exes?
        - i think this is normal way, yeah
        - it's 2020, time to let 32-bit die...
  

[maintanence]
 - fix up project requirements. can probably update all the dependencies (even python)
    - why though?
 
 
[what's stressing me out?]
 - won't ever finish
    - potentially true. it's up to you
 - "it took you X years to make this?"
    - it's hard to predict reception. don't let it paralyze you.
 - new players will struggle and quit
    - you'll playtest the tutorial system before release, and you might be 
        surprised at how well players can figure this stuff out.
 - boss fights aren't very interesting
    - you weren't even supposed to *have* those in the first place, remember? 
        just having them at all is more interesting than not, and they don't 
        necessarily need to play a huge role in the game to be memorable.
    - also they're actually better than they seem
        - frog boss tests the player's ability to sidestep attacks
        - robot boss tests player's ability to use CC
 - none of it's very interesting
    - done is better than interesting
    
 
[architecture]
    - entities should keep a reference to the world they're in
        - instead of passing the world into literally every method
    
    
[content design philosophy]
    - done is better than good
    - but if it's bad cut it
    - after two tries, move on
    
        
[future features]
 - alternate ending for deathless / cp-less runs
    - fight the cloning machine? lol
 - when you go "back" to a previous menu, you should return to the same selected idx
 - [WASD to move] tutorial doesn't look good
    - honestly it's probably fine
    - render it underneath the player maybe?
 - traps / ground effects
    - not sure how much sense this makes, given that enemies can already block you pretty fiercely
 - enemies picking up items (intelligence >= 4)
    - we'd want an "arms up" sprite for eligible enemies I think
 - holding the up/down key in menus should continue scrolling
    - careful, the hold-down behavior on keys differs between OSes
        - (meaning this might already be a thing on windows / mac)
 - projectiles should get a color based on the item/status or something
 - tiles that alter movement
    - jump / teleport tiles
        - an interesting way to get away from enemies, assuming they don't follow you
        - could use "ReturnExitEntity" sprites for this
            - although tests have shown people are afraid of it..
        - this also makes the maps a lot more "mazy" and harder to visualize
    - ice tiles
        - these would be interesting to try to generate
        - enemy pathing on these would be a bit tricky / interesting
    - water tiles (kill or hurt you when you fall in)
        - only meaningful if knockback is a thing
    - one-way tiles
        - (not sure what these would be good for, honestly.)
            - force engagement?
                - running away is sorta hopeless already
                    - and turtling in doorways only works if you can facetank the enemy
 - new (secondary) item stats
    - poison duration
    - confusion duration
 - quest system
 - permanent effects (aka curses)
    - only fun if it truly changes your options somehow
    - and it's obligitory to have different art
 - doors that can only be unlocked with "keys"
 - varying scenery
    - bridges over deep pits, water pits
 
 - figure out whether it's possible to make/distribute mac builds
    - no opengl? no app notarizaiton w/out developer account? looking grim...
        - confident i could do this iff i had a mac computer at my disposal
            - 300-400 for a cheap laptop
                - 600-800 probably more realistic (refurb'd 2015 macbook air?)
            - 150-200 for a mac mini (are these even computers?)
 
 - make enemies move at the same time as you...?
    - this would be my #1 complaint with the game if I were a player
    - there's a reason why all other roguelikes do this...
    - this will require a lot of work though
        - essentially:
            - gets complicated when enemies are taking multiple actions during a single player turn
            - we actually don't even know in advance how many total steps will be taken by enemies during this phase
                - depends on various speed-affecting actions that may or may not be taken
            - so it seems like we'd have to pre-compute the entire phase, and play it back at the proper speed
            - actually, it might not be so bad if only MoveActions are affected
                - but I want to be able to toggle other things too.
            - actually, if we could represent the worldstate (as it pertains to actors) in more abstract way..
            - HMMM
            
            - Plan A
                - player chooses an action A0.
                - take a snapshot S0 of the current worldstate (or a relevant part of it)
                - compute S1 = A0(S0) (the worldstate after the player's action has resolved)
                - compute the first enemy's action A1 given S1, and let S2 = A1(S1)
                    - if A_e1 is non-concurrent, animate Ap, then A1
                    - else find A2, A3, A4, and so on until a non-concurrent action is found 
                        - or until it's the player's turn again
                        - hidden enemies do not animate, and therefore their actions are always concurrent
                        - if the player is gone (AKA dead), all actions are non-concurrent
                        
                - then: during animation, sort the actions into lists for each actor
                - and animate them concurrently 
                    - increasing the anim rate for longer lists so that all animations finish at the same time.
                    
            - issues with Plan A:
                - how to represent the state of an actor?
                    - position
                    - HP
                    - energy
                    - base stats
                    - list of stat modifiers (with X turns remaining)
                        - this basically includes items and status effects
                        
                - how to handle 'unusual actions' like interacting with scenery or talking to an NPC?
                    - have them be "non-concurrent" and skip this entire process
                - how to update the 'true' worldstate after the animation phase has occurred?
                    - just finalize actions as they occur (mid-animation)?
                        - no, they absolutely must be called in order
                    - do a "full finalize" of the world at the end?
                    - refactor current world to have it basically represented this way to begin with
                        - aka decouple the model from the view
                
 - use N "dividers" on HP bar where N = max health
 
 - when enemies are "flinched" it should be shown to the player somehow
    - in the tooltip?
    - this should be done with pink zees I think, and other status effects should have similar effects
        - or just regular zees?
        - or just flash the status's color...?
    

[rejected future features]
 - consider allowing two weapons to be equipped at maximum
    - there currently is almost no reason to have more than 1, let alone two
    - this would allow for a simpler UI
        - you'd have an active / offhand weapon, and a button to swap
    - would allow weapons to have global stats (not currently possible because 
      it'd become more efficient to stack small weapons instead of cubes)
    - would need to elegantly "fail to equip" somehow
 - putting skeletons back together with bone pieces
  


[~dream features~]
 - farming
    - if you can dream it you can meme it
 
 
[P3 bugs / won't fix]
    - going in and out of fullscreen mode loses the window position (or something like that?)
    - offscreen light sources that are somewhat nearby will make offscreen enemies act non-instantly
        - for now, let's just not have any enemies that emit light by default
            - oops, tree boss emits light...
    - HP on kill doesn't trigger when you kill an enemy with poison
        - I think this makes the game better. leave it.
            - It also doesn't go towards kill count, which makes peaceful runs possible (I think~)
    - as frog boss is leaping diagonally, it'll activate player's attack targeting squares
    - right clicking a potion in the equipment grid moves it to the inventory (it should consume)
        - should it?
    - if you have temporary speed boost that's about to expire, enemies with z's can act after you move
        - need to math a little harder here (or just leave it...)
        
[playtesting notes]

 - coffee shop guy (nervous dog) (7/21/19)
    situation: stranger, asked what i was working on, i offered to let him playtest
    - 45 minutes, made it through 2 levels
    - thought flashing red dagger meant it would break soon
    - couldn't figure out how to pick up items (mouse)
    - couldn't figure out how how to open inventory
    - couldn't figure out how how to rotate items
    - avoided ReturnExitEntity, thought it was fire and would kill him
        - correct behavior, but incorrect reasoning. probably fine?
    - put dagger into inventory instead of equipment grid
    - but figured out how to use the dagger from hotbar without help (pressed 1)
    - lot of awkward hand alternating with controls
    - compulsively picking up, equipping items
        - swapping an rearranging items even when their stats were the same
        - judging items based on color, rather than stats? 
            - thought a yellow item affected speed.
        - eventually became seemingly annoyed whenever an item would drop, would check phone, look away, etc
        - filled up entire inventory with garbage items
    - thought vitality was different from HP
    - seemed bored, playing to pass the time and be polite
        - obv not a fan of the genre, but concerning nonetheless
    - story seemed to amuse him at first, bore him as time went on
    - said art was good, but "programming seems basic"
        - not sure what this means, hurt though lol
    - didn't understand why he couldn't pick up items two squares away
    
    takeaways: 
        - ~early game is slow, easy, confusing, and boring~
        - way too many chests
        - need in-game tutorial
        - shift click to auto-pickup items
        - better indicator when item is too far away to be picked up
        - needs to be possible to die in early levels
        - early levels potentially should be a lot smaller?
        - might want to prevent "ATT" items from being pure yellow
        
 - jeff (home) (8/25/19)
    situation: friend, invited him to playtest
        - 35 minutes, played four games, died at caves 2 or 3 each time
        - most early tutorials in place, game was untuned, pretty hard
    good:
        - equipment and rotation tutorials worked!
        - used item tooltips to decide what to replace when equip space ran out
    neutral:
        - scared of enemies at first, wouldn't fight anything
        - used mouse + inventory hotbar button to open inventory thereafter
    bad:
        - pressed arrow keys before "[WASD]" message appeared, used them throughout
        - had to instruct how to use potions (tried dragging it onto player)
            - didn't really get to see tutorial text because it was on mouse while trying to use it.
        - often tried moving items via drag-n-drop instead of click-move-click
        - rapidly mashed movement keys while fighting, didn't seem to grasp concept of turn-basedness
            - kept doing it after i explained why it wasn't necessary, kept doing it anyways
            - perhaps more of a mental tic in response to stress
        - ran past enemies even whenever possible, causing him to recieve no potions and die in later levels
        - didn't realize you could attack enemies by running into them
        - struggled to equip dagger
            - tried dragging it onto player
            - tried right-clicking it in inventory
            - confused about what "Throwable" meant
            - had to instruct how to select it (there's no in-game explanation for this currently)
        - noticed Zzz's on enemies, but didn't understand what it meant or how to take advantage
            - even after explanation and demonstration, couldn't (immediately~) start fighting slow enemies safely 
        - never tried hovering over enemies to see stats
        
    takeaways:
        - need to streamline the way weapons are equipped. 
            - it should *just work* when you put a weapon into the equipment grid
            - only two attacks available, and a maximum of two weapons equipped
        - there should be a way to recover life at the end of a level
        - drag-n-drop should work
        - disable arrow keys as default controls, it just screws people up
        - need some non-enemy challenges in early levels, to introduce the movement and turn system
        - clicking a potion onto yourself should probably just use it~
        - clicking an equipment onto yourself should equip it if possible
        
        
[beta testing notes]
  situation: all done remotely on version 0.1.1-BETA, when I asked for 
             volunteers on twitter. sent out private DL links. was mostly
             interested in whether the game would run for everyone.
  - jonny
    - said it was fun, strategic, challenge to get past the first area
    - enjoyed filling up the grid
    - gathered many knives lol
    - said mary explained fighting well
        - (i had given some guidance prior to that)
    - liked the town! talked to the ppl!
  
  - alex
    - chrome & windows both popped 'suspicious file' warnings
        - we must end the tyranny of microsoft and google
    - liked the ASCII map
    - read info.txt before playing, which inspired several strange ideas:
        - thought 'jumping' was a seperate action, that wasn't included in controls menu
        - thought clicking was the prefered way to attack, and running into things was wrong
        - thought filling the grid would do something special 
            - (mostly my fault for jokingly implying it would, lol)
        - tutorials were annoying, because things like opening the map etc. had already been done
            - in a previous run, so the tutorial skip detection didn't work
    - died once (I think) before spider zone
        - "feels like I'm playing wrong"
    - liked spider music, general look & feel, checkpoint design
    - swamps are a big difficulty spike
        - "dying too much"
    - likes the turn counter on load menu
    - ended up pretty underpowered at the swamps, unable to make much progress
        - no potions
        - att: 6, def: 2, vit: 9
    - quit at that point
    - all in all, didn't seem to enjoy the game very much
            
  - dk
    - runs well on his potato
    - got to the swamps
        - quit to get dinner
    - came back
    - slugs were tough
        - is it optimistic to assume players won't get hit by slugs?
    - it FAILED TO SAVE
        - could still continue from checkpoints (good)
        - but no save_data directory was ever created
        - after flipping the read-only flag on the 'Skeletris' folder it became fixed?
        - although that shouldn't matter
        - unclear if he restarted the game after flipping the box to make it work or what
        - the real issue here is that there's no way to diagnose this problem remotely
    - went silent as we were investigating the saving issue
    
  - necro
    - runs well, likes the feel
    - didn't play too long, enjoyed it though
    - claimed to quit for IRL reasons
    
  - av reference
    - sent me a very detailed list of his thoughts, super helpful:

        "Hi there! I downloaded and successfully run the game on Windows 10. 
         Here are some considerations after some time playing; I arrived to 
         the first save point and the swamps."

        "1. I like the graphic and music very much but if you are planning to 
            sell it some people would aspect more atmosphere and details."
        "2. I found some fx sounds to be slightly louder, like when you are hit 
            by an enemy or when you heal with a potion."
        "3. The game runs smooth; custom controls are perfect as some people like 
            me prefer to use arrows rather than wasd."
        "4. The idea of fitting items like a puzzle is very nice."
        "5. Why would you skip a turn? There seems to be a lack of information 
            about that. The jump is cute!"
        "6. I like the map; sometimes it didn't show the doors, other times it 
            did with a O."
        "7. The saved data load perfectly."
        
        - beginning isn't engaging enough
            - should think about improving this post-release
        - should dial back the potion / damage sounds a bit perhaps?
            - i feel like all the sounds are pretty loud, lol
        - improve mary's dialog to include some info about turn skipping?
            - if players can't learn this they'll likely be unable to progress
        - likely some confusion about doors going away when they're opened
            - tested to make sure and it seems to work correctly
  
  takeaways: 
    - it ran well on everybody's computers!! (all used windows, I believe)
        - except for DK whose game was failing to write anything to disk
            - fixed by jibbling the 'read-only' checkbox on the folder??
    - but people didn't seem to want to play for very long
    - swamps was a major dropping off point
        - not sure why though, exactly
            - crabs, ghasts, and cyclopses, might be a bit much (FIXED? by v0.1.2)
    - remote "playtesting" is so bad compared to in-person
        - obviously...
    - need better handling for when the game is unable to write to disk
        - logging wouldn't help here (can't write logs either...)
        - pop a message with the stacktrace to the screen maybe?
            - when? at save time?
            - this is so messy
    - game data should be be saved to the OS's AppData folder, not the working directory
        - this is likely the root cause of DK's saving issue
        - although it's unclear why it couldn't write to the desktop or why
          closing and reopening the game fixed those issues...
             

[game name]

    [CAN'T USE] Cubelike 
        - blend of roguelike and "cube" (?)
        - been using this as the name since the beginning
        - don't really want to use word "Cube" because it's awkward to say/hard to hear
            - "it's called kyubelike"
            - what?
            - "it's cube-like, like roguelike, if you pronounce it wrong"
    
    Skeletris
        - pros:
            - sounds cool
            - available
            - this can also be the name of the city in which the game takes place
        - cons:
            - similar to "Dungetris" which is an existing indie tetris-roguelike fusion
                - games are totally different though, probably fine to use
            - says basically nothing about the game except "there are skeletons + tetris"
            - there are like four ppl using this name on social media accounts
                - sorry kids, it's mine now
    
    Slap Monsters, Find Loot
        - cute, memorable, 2nd half needs work
        - hate the word "loot"
        - SMFL = "ess em eff ell" sucks
        
    Slap Monster, Get Treasure
        - pros:
            - SMGT = "ess em gee tee", pretty good, acronym available
            - sounds like lgbt
            - describes all important parts of the game
        - cons:
            - ambiguously necessary comma
            - ambiguously necessary "s" after Monster
            - it's too stupid
            - one day later, i hate it
            
    [CAN'T USE] Tomb of the Mushroom King
        - cons:
            - identical to "Crypt of the Fungal Lord", which exists
            - similar to "Curse of the Mushroom King", which exists
            
            
A remnant of the past:

   "Note: The game is quite difficult, and it's probably not for everyone. 
   If you become surrounded or get hit by something nasty, you'll likely 
   die. And have to start over. The idea is that each death will teach a 
   lesson, and as those lessons are learned, you'll stop getting hit and 
   the game will feel more fair and satisfying :)"

            
